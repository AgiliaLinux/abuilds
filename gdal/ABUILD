# ABUILD generated by mkpkg_generator.sh

pkgname=gdal
pkgver=1.7.3
pkgbuild=2
arch=("auto")

shortdesc=("Gdal (Geospatial Data Abstraction Library)")
longdesc=("Gdal is a translator library for raster geospatial data formats that is released under an X/MIT style Open Source license. As a library, it presents a single abstract data model to the calling application for all supported formats.")

tags=("libs sci-libs")

source=("http://download.osgeo.org/${pkgname}/${pkgname}-${pkgver}.tar.gz")

build() {
	go_src_dir
	burn_patches

	export CFLAGS="$SLKCFLAGS -fno-strict-aliasing"
	./configure --prefix=/usr \
		--libdir=/usr/lib${LIBDIRSUFFIX} \
		--mandir=/usr/man \
		--with-netcdf \
		--with-libtiff \
		--with-sqlite3 \
		--with-geotiff \
		--with-mysql \
		--with-python \
		--without-libtool \
		--with-curl \
                --with-hdf5 \
		--with-perl \
		--with-geos \
		--with-png \
		--with-libz=/usr/lib${LIBDIRSUFFIX} \
		--with-curl=/usr/bin/curl-config \
		--with-hide-internal-symbols=yes \
		--enable-static=no

	sed -i 's/PY_HAVE_SETUPTOOLS=1/PY_HAVE_SETUPTOOLS=/g' ./GDALmake.opt
	sed -i 's/EXE_DEP_LIBS/KILL_EXE_DEP_LIBS/' apps/GNUmakefile
	install -d ${pkgdir}/usr/lib${LIBDIRSUFFIX}/python2.7/site-packages/

	make -j${NUMJOBS}
	make DESTDIR=${pkgdir} install

	rm -f ${pkgdir}/usr/bin/*.dox

}
