# ABUILD generated by spkg2abuild converter from smplayer-0.6.9-1.spkg

# Package metadata
pkgname=smplayer
pkgver=0.8.4
pkgbuild=1
arch="auto"

# Package description
shortdesc=("SMplayer (Qt4 Mplayer front-end)")
longdesc=("SMPlayer intends to be a complete front-end for MPlayer, from basic features  like  playing  videos, DVDs, and  VCDs  to more advanced features like support for MPlayer filters and more.")

# Source URL
source=("http://downloads.sourceforge.net/smplayer/smplayer-${pkgver}.tar.bz2")

# Tags
tags="xapps media-video"
adddep="MPlayer"

# Main build script
build() {
	go_src_dir
	burn_patches
	set -e
	sed -i "s|translations/smplayer_gl.ts|#translations/smplayer_gl.ts|" src/smplayer.pro
 
 smdoc="/share/doc/packages/smplayer"
 if [ -n "`cat ./Makefile | grep DOC_PATH | grep $smdoc`" ]; then
  sed -i "/^DOC_PATH=/s|$smdoc|/doc/${pkgname}-${pkgver}|" ./Makefile || exit 1
 fi

	make PREFIX=/usr -j${numjobs}
	make PREFIX=/usr DESTDIR=${pkgdir} install

	install -dm755 ${pkgdir}/usr/share/pixmaps
	ln -s /usr/share/icons/hicolor/64x64/apps/smplayer.png \
		          ${pkgdir}/usr/share/pixmaps/

	sed -i 's|Exec=smplayer %U|Exec=smplayer %F|' \
		${pkgdir}/usr/share/applications/smplayer.desktop
	sed -i 's|Exec=smplayer -add-to-playlist %U|Exec=smplayer -add-to-playlist %F|' \
		${pkgdir}/usr/share/applications/smplayer_enqueue.desktop

	set +e
}

