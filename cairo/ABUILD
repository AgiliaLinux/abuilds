# ABUILD generated by mkpkg_generator.sh

pkgname=cairo
pkgver=1.12.14
pkgbuild=1
arch=('auto')

shortdesc=('cairo (graphics library used by GTK+)')
longdesc=('Cairo is a vector graphics library designed to provide high-quality display and print output. Cairo is designed to produce identical output on all output media while taking advantage of display hardware acceleration when available (eg. through the X Render Extension or OpenGL).')

tags=('libs x11-libs')

source=("http://cairographics.org/releases/cairo-${pkgver}.tar.xz")

# Changelogs are 6mb big, so let's disable doc copying.
custom_opts="no_copydoc"


build_deps="libpng libXrender libXext libX11 fontconfig pixman glib2 mesa libgl lzo libxcb pkg-config renderproto xproto xextproto"


before_build() {
	go_src_dir
	#export ax_cv_c_float_words_bigendian=no
}

# You can try to enable it, but I failed to build with this.
#GALLIUM_OPTIONS="--enable-gallium \
#	--enable-drm \
#	--enable-xcb-drm"

BUILD_SYSTEM='autotools'
BUILD_KEYS="--prefix=/usr \
	--libdir=/usr/lib$LIBDIRSUFFIX \
	--enable-xcb \
	--sysconfdir=/etc \
	--mandir=/usr/man \
	--localstatedir=/var \
	--docdir=/usr/doc/${pkgname}-${pkgver} \
	--disable-static \
	--enable-svg \
	--enable-ft \
	--enable-ps \
	--enable-pdf \
	--enable-png \
	--enable-xml \
	--enable-gobject \
	--disable-xlib-xcb \
	--disable-valgrind \
	--with-x \
	--enable-xlib \
	--enable-xlib-render \
	--enable-gobject \
	--enable-gl \
	--enable-egl \
	--enable-xcb \
	--enable-tee \
	--enable-script \
	$GALLIUM_OPTIONS"

#	--enable-glesv2 \ # broken with --enable-gl at one time

INSTALL_KEYS="DESTDIR=$pkgdir"

after_build()
{
    # It looks like libpng1.2 appears here
    find "${pkgdir}" -name '*.la' -exec rm -f {} +
}