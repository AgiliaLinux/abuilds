# ABUILD generated by mkpkg_generator.sh

pkgname=screen
pkgver=4.0.3
pkgbuild=3
arch=("auto")

shortdesc=("screen (screen manager with VT100/ANSI terminal emulation)")
longdesc=("Screen is a full-screen window manager that multiplexes a physical terminal between several processes (typically interactive shells). Each virtual terminal provides the functions of a DEC VT100 terminal and several control functions from the ISO 6492 (ECMA 48, ANSI X3.64) and ISO 2022 standards (e.g. insert/delete line and support for multiple character sets). There is a scrollback history buffer for each virtual terminal and a copy-and-paste mechanism that allows moving text regions between windows.")

tags=("console app-misc")

source=("http://ftp.gnu.org/gnu/screen/screen-${pkgver}.tar.gz")

build_deps="ncurses linux-pam perl"
config_files="etc/screenrc
etc/skel/.screenrc"
build() {
	go_src_dir
	burn_patches

	./configure --prefix=/usr \
		--with-sys-screenrc=/etc/screenrc \
		--with-pty-mode=0620 \
		--with-pty-group=5 \
		--enable-telnet \
		--disable-socket-dir \
		--enable-locale \
		--enable-colors256 \
		--enable-rxvt_osc \
		--build=$ARCH-slackware-linux

	# Substitutions:
	perl -pi -e 's|.*#undef HAVE_BRAILLE.*|#define HAVE_BRAILLE 1|' config.h
	perl -pi -e 's|/usr/local/etc/screenrc|/etc/screenrc|' etc/etcscreenrc doc/*
	perl -pi -e 's|/local/etc/screenrc|/etc/screenrc|' doc/*

	# Build screen:
	make -j${numjobs}
	make install DESTDIR=${pkgdir}

	install -Dm0644 etc/screenrc ${pkgdir}/etc/screenrc
	install -Dm0644 etc/screenrc ${pkgdir}/etc/skel/.screenrc

}
