# ABUILD generated by mkpkg_generator.sh

pkgname=net-tools
pkgver=1.61
pkgbuild=1
arch=("auto")

shortdesc=("net-tools (base Linux networking utilities)")
longdesc=("This is the core collection of tools such as "ifconfig" and "route" used to configure networking on Linux. You won't be able to do much networking without this package and the network-scripts. The net-tools package was maintained for many years by Phil Blundell and Bernd Eckenfels.")

tags=("network net-misc")

# 1.60 released years ago, so even Slackware uses git snapshot. We will use latest trunk, of cource :)
source=("git:git://net-tools.git.sourceforge.net/gitroot/net-tools/net-tools")
build_deps="glibc-solibs git"

build() {
	go_src_dir
	burn_patches
	cat ${filedir}/net-tools.config.h > config.h
	HAVE_IP_TOOLS=1 HAVE_MII=1 make -j${numjobs}
	HAVE_IP_TOOLS=1 HAVE_MII=1 make hostname -j${numjobs}
	for prog in arp ifconfig rarp route mii-tool nameif plipconfig ipmaddr iptunnel ; do
		install -Dm0755 $prog ${pkgdir}/sbin/$prog
	done
	install -Dm0755 hostname $pkgdir/bin/hostname
	install -Dm0755 netstat $pkgdir/bin/netstat
	install -Dm0755 slattach $pkgdir/usr/sbin/slattach
	( cd man/en_US
		for page in dnsdomainname.1 domainname.1 hostname.1 nisdomainname.1 ypdomainname.1 ; do
			install -Dm0644 $page $pkgdir/usr/man/man1/$page
		done
		install -Dm0644 ethers.5 $pkgdir/usr/man/man5/ethers.5
		for page in arp.8 ifconfig.8 mii-tool.8 nameif.8 netstat.8 rarp.8 route.8 slattach.8 plipconfig.8 ; do
			install -Dm0644 $page $pkgdir/usr/man/man8/$page
		done
	)
	( cd $pkgdir/bin
		ln -sf hostname dnsdomainname
		ln -sf hostname nisdomainname
		ln -sf hostname ypdomainname
	)

	# This is a little Slackware-specific tool used in some of the network
	# related scripts to calculate network and broadcast addresses:
	( cd $pkgdir/bin
		cc -O2 -o ipmask $filedir/ipmask.c
		chmod 755 ipmask
	)
	install -Dm0644 ${filedir}/ipmask.8 $pkgdir/usr/man/man8/ipmask.8
}
