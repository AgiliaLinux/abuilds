# ABUILD generated by mkpkg_generator.sh

pkgname=libpng12
_basename=libpng
pkgver=1.2.50
_apngver=${pkgver}
pkgbuild=1
arch=("auto")

shortdesc=("A collection of routines used to create PNG format graphics files.")
tags=("media-libs libs")
source=("http://downloads.sourceforge.net/sourceforge/${_basename}/${_basename}-${pkgver}.tar.xz"
"http://downloads.sourceforge.net/sourceforge/libpng-apng/libpng-$_apngver-apng.patch.gz")
build_deps="zlib"

before_build() {
  go_src_dir
  # Add animated PNG (apng) support
  # We need to patch the patch
  cp ${srcache}/libpng-${_apngver}-apng.patch .
  patch -p1 -i libpng-${_apngver}-apng.patch
}

BUILD_SYSTEM="autotools"
BUILD_KEYS="--prefix=/usr \
  --libdir=/usr/lib$LIBDIRSUFFIX \
  --mandir=/usr/man \
  --sysconfdir=/etc"
INSTALL_KEYS="DESTDIR=$pkgdir"


after_build() {
  go_src_dir
  rm -rf "${pkgdir}/usr/man"
  rm -rf "${pkgdir}/usr/bin/libpng-config"
  rm -rf "${pkgdir}/usr/lib${LIBDIRSUFFIX}/libpng."{so,a,la}
  rm -fr "${pkgdir}/usr/lib${LIBDIRSUFFIX}/pkgconfig/libpng.pc"
  rm -rf "${pkgdir}/usr/include/"{pngconf.h,png.h}
}

